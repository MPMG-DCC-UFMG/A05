!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3-array"),require("d3-scale")):"function"==typeof define&&define.amd?define(["exports","d3-array","d3-scale"],e):e(t.d3=t.d3||{},t.d3,t.d3)}(this,function(t,e,a){"use strict";const r="dot",n="tick";t.boxplot=function(){let t=!1,e=a.scaleLinear(),o=20,i=20,s=!0,l=r,c=.8,d=.2,p=void 0;function u(a){const u=t?"y":"x",f=t?"x":"y",m=t?"width":"height",$=t?(t,e)=>[e,t]:(t,e)=>[t,e],h=e.range()[0]>e.range()[1],y={};y[r]={nodeName:"circle",enter:function(t){t.attr("fill","currentColor").attr("stroke","none").attr("opacity",0).attr("r",0).attr(`c${u}`,t=>e(t.value)).attr(`c${f}`,v)},update:function(t){t.attr("opacity",c).attr("r",t=>t.farout?1.5*k:k).attr(`c${u}`,t=>e(t.value)).attr(`c${f}`,v)},exit:function(t){t.attr("opacity",0).attr("r",0)}},y[n]={nodeName:"line",enter:function(t){t.attr("stroke","currentColor").attr("opacity",0).attr(`${u}1`,t=>e(t.value)).attr(`${u}2`,t=>e(t.value)).attr(`${f}1`,0).attr(`${f}2`,0)},update:function(t){t.attr("opacity",c).attr(`${u}1`,t=>e(t.value)).attr(`${u}2`,t=>e(t.value)).attr(`${f}1`,Math.min(-2,-.25*i)).attr(`${f}2`,Math.max(2,.25*i))},exit:function(t){t.attr("opacity",0).attr(`${f}1`,0).attr(`${f}2`,0)}};const g=y[l],x=a.selection?a.selection():a,b=t=>`M${$(e(t.start),-.5*i)} l${$(0,i)} `+`m${$(0,-.5*i)} L${$(e(t.end),0)}`,v=0===d?0:(t,e)=>.5*Math.sin(1e5*(e+t.value))*(t.farout?0:t.outlier?.5:1)*d*o,k=Math.max(1.5,.5*Math.sqrt(o));let w=x.select("g.whisker");w.empty()&&(w=x.append("g").attr("class","whisker").attr("transform",`translate(${$(0,.5*o)})`));let M=x.select("g.box");M.empty()&&(M=x.append("g").attr("class","box").attr("transform",`translate(${$(0,.5*o)})`));let N=x.select("g.point");N.empty()&&(N=x.append("g").attr("class","point").attr("transform",`translate(${$(0,.5*o)})`));let q=w.selectAll("path").data(t=>t.whiskers);q=q.enter().append("path").attr("fill","none").attr("stroke","currentColor").attr("opacity",0).attr("d",b).merge(q);let A=M.selectAll("line").data(t=>t.boxes);A=A.enter().append("line").attr("stroke","currentColor").attr("stroke-width",i).attr("opacity",0).attr(`${u}1`,(t,a)=>e(t.start)+(0===a?0:.5)*(h?-1:1)).attr(`${u}2`,(t,a)=>e(t.end)-(0===a?.5:0)*(h?-1:1)).attr(`${f}1`,0).attr(`${f}2`,0).attr(m,i).merge(A),N.selectAll(".point").filter(function(){return this.nodeName!==g.nodeName}).remove();let C=N.selectAll(".point").data(t=>s?t.points:t.points.filter(t=>t.outlier),p?t=>p(t.datum):void 0),j=C.exit();return C=C.enter().append(g.nodeName).attr("class","point").call(g.enter).merge(C).classed("outlier",t=>t.outlier).classed("farout",t=>t.farout),a!==x&&(w=w.transition(a),M=M.transition(a),N=N.transition(a),q=q.transition(a),A=A.transition(a),C=C.transition(a),j=j.transition(a)),w.attr("transform",`translate(${$(0,.5*o)})`),M.attr("transform",`translate(${$(0,.5*o)})`),N.attr("transform",`translate(${$(0,.5*o)})`),q.attr("opacity",c).attr("d",b),A.attr("opacity",c).attr("stroke-width",i).attr(`${u}1`,(t,a)=>e(t.start)+(0===a?0:.5)*(h?-1:1)).attr(`${u}2`,(t,a)=>e(t.end)-(0===a?.5:0)*(h?-1:1)).attr(`${f}1`,0).attr(`${f}2`,0),C.call(g.update),j.call(g.exit).remove(),this}return u.vertical=((...e)=>e.length?(t=e[0],u):t),u.scale=((...t)=>t.length?(e=t[0],u):e),u.showInnerDots=((...t)=>t.length?(s=t[0],u):s),u.bandwidth=((...t)=>t.length?(o=t[0],u):o),u.boxwidth=((...t)=>t.length?(i=t[0],u):i),u.symbol=((...t)=>t.length?(l=t[0],u):l),u.opacity=((...t)=>t.length?(c=t[0],u):c),u.jitter=((...t)=>t.length?(d=t[0],u):d),u.key=((...t)=>t.length?(p=t[0],u):p),u},t.boxplotStats=function(t,a){const r=a?t.map(a):t,n=[0,.25,.5,.75,1].map(t=>e.quantile(r,t)),o=n[3]-n[1],i=1.5*o,s=[{start:n[1]-i-i,end:n[1]-i},{start:n[1]-i,end:n[1]},{start:n[1],end:n[3]},{start:n[3],end:n[3]+i},{start:n[3]+i,end:n[3]+i+i}],l=[{start:n[1],end:n[2]},{start:n[2],end:n[3]}],c=[{start:e.min(r.filter(t=>s[1].start<=t)),end:n[1]},{start:e.max(r.filter(t=>s[3].end>=t)),end:n[3]}],d=r.map((e,a)=>({value:e,datum:t[a],outlier:e<s[1].start||s[3].end<e,farout:e<s[0].start||s[4].end<e}));return{fiveNums:n,iqr:o,step:i,fences:s,boxes:l,whiskers:c,points:d}},t.boxplotSymbolDot=r,t.boxplotSymbolTick=n,Object.defineProperty(t,"__esModule",{value:!0})});